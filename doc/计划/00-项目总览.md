# Earnlytics 项目文档

> **状态**: Plan 1 ✅ 100% | Plan 2 ✅ 100% | Plan 3a ✅ 100% | Plan 3b ✅ 100% | Plan 3c ⏳ 待开始
> **更新时间**: 2026-02-14 (基于代码实际状态)
> **设计文件**: [pencil-earnlytics.pen](./pencil-earnlytics.pen)
> **生产环境**: https://earnlytics-ebon.vercel.app

---

## 📋 项目概述

Earnlytics 是一个**AI驱动的美国科技公司财报分析平台**，为中国投资者提供快速、易懂的中文财报解读。

### 核心价值主张

1. **速度**: 财报发布后 1 小时内生成 AI 分析
2. **易读**: 复杂财务数据转化为中文摘要
3. **专注**: 覆盖 30+ 科技巨头（AAPL, MSFT, NVDA 等）
4. **免费**: 基础功能永久免费

---

## 🎨 设计系统

### 设计稿完成情况

**已完成 13 个页面设计**（详见设计文件）:

| 页面类型 | 页面名称 | 设计 ID | 状态 |
|---------|---------|---------|------|
| **营销页面** | Landing Page | ZAmlV | ✅ 已完成 |
| **用户系统** | Sign Up Page | VxmOF | ✅ 已完成 |
| **用户系统** | Login Page | mmO4y | ✅ 已完成 |
| **用户系统** | User Profile | NAQg7 | ✅ 已完成 |
| **核心功能** | Home Page | VrH0K | ✅ 已完成 |
| **核心功能** | Calendar Page | J0KoA | ✅ 已完成 |
| **核心功能** | Companies Directory | SIzPO | ✅ 已完成 |
| **核心功能** | Earnings Detail | dBqfg | ✅ 已完成 |
| **系统页面** | 404 Page | 3gD89 | ✅ 已完成 |
| **系统页面** | About Us | 6Mu38 | ✅ 已完成 |
| **设计系统** | Component States | BX743 | ✅ 已完成 |
| **设计系统** | Responsive Design | c0Eox | ✅ 已完成 |
| **共享组件** | Header Component | GA7Uf | ✅ 已完成 |

### Design Token 系统

**颜色变量**:
```css
--primary: #2563EB          /* 主品牌色 */
--primary-hover: #1D4ED8    /* 悬停状态 */
--primary-light: #EFF6FF    /* 浅色背景 */
--background: #FAFAFA       /* 页面背景 */
--surface: #FFFFFF          /* 卡片背景 */
--text-primary: #0F172A     /* 主文字 */
--text-secondary: #64748B   /* 次要文字 */
--text-tertiary: #94A3B8    /* 辅助文字 */
--border: #E2E8F0           /* 边框 */
--success: #16A34A          /* 成功状态 */
--warning: #991B1B          /* 警告状态 */
--info: #1E40AF             /* 信息状态 */
```

**间距系统**:
```css
--spacing-1: 4px
--spacing-2: 8px
--spacing-3: 12px
--spacing-4: 16px
--spacing-6: 24px
--spacing-8: 32px
--spacing-12: 48px
--spacing-16: 64px
--spacing-20: 80px
```

**圆角系统**:
```css
--radius-sm: 6px   /* 标签、小按钮 */
--radius-md: 8px   /* 按钮、输入框 */
--radius-lg: 12px  /* 卡片 */
--radius-xl: 16px  /* 大卡片、模态框 */
```

**字体系统**:
- 字体家族: Inter
- 标题层次: 48px / 40px / 32px / 24px / 20px
- 正文层次: 18px / 16px / 14px / 12px

---

## 🏗️ 技术架构

### 技术栈

```
前端: Next.js 14 + React + TypeScript + Tailwind CSS
组件库: shadcn/ui
后端: Vercel Serverless + Supabase
数据库: PostgreSQL (Supabase)
AI: DeepSeek API
自动化: GitHub Actions
部署: Vercel (ISR)
```

### 数据库 Schema

```sql
-- 公司表
CREATE TABLE companies (
  id SERIAL PRIMARY KEY,
  symbol VARCHAR(10) UNIQUE NOT NULL,
  name VARCHAR(100) NOT NULL,
  sector VARCHAR(50),
  logo_url VARCHAR(255),
  created_at TIMESTAMP DEFAULT NOW()
);

-- 财报表
CREATE TABLE earnings (
  id SERIAL PRIMARY KEY,
  company_id INTEGER REFERENCES companies(id),
  fiscal_year INTEGER NOT NULL,
  fiscal_quarter INTEGER NOT NULL,
  report_date DATE NOT NULL,
  revenue NUMERIC(20, 2),
  revenue_yoy_growth DECIMAL(5, 2),
  eps DECIMAL(10, 2),
  eps_estimate DECIMAL(10, 2),
  eps_surprise DECIMAL(10, 2),
  net_income NUMERIC(20, 2),
  is_analyzed BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(company_id, fiscal_year, fiscal_quarter)
);

-- AI分析表
CREATE TABLE ai_analyses (
  id SERIAL PRIMARY KEY,
  earnings_id INTEGER REFERENCES earnings(id) UNIQUE,
  summary TEXT NOT NULL,
  highlights JSONB,
  concerns JSONB,
  sentiment VARCHAR(20),
  tokens_used INTEGER,
  cost_usd DECIMAL(10, 6),
  created_at TIMESTAMP DEFAULT NOW()
);

-- 用户表 (Supabase Auth)
-- 订阅表
CREATE TABLE subscriptions (
  id SERIAL PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  tier VARCHAR(20) NOT NULL, -- free/pro/team
  status VARCHAR(20),
  created_at TIMESTAMP DEFAULT NOW()
);

-- 邮件订阅表
CREATE TABLE subscribers (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  is_active BOOLEAN DEFAULT TRUE,
  subscribed_at TIMESTAMP DEFAULT NOW()
);
```

---

## 📱 页面开发清单

### Phase 1: 核心页面（Week 1-2）

| 优先级 | 页面 | 依赖 | 工作量 |
|-------|------|------|--------|
| P0 | Landing Page | - | 2天 |
| P0 | Home Page | Header, Footer | 1天 |
| P0 | Login Page | - | 0.5天 |
| P0 | Sign Up Page | - | 0.5天 |
| P0 | 404 Page | - | 0.5天 |
| P1 | Companies Directory | Card组件 | 1天 |
| P1 | Earnings Detail | 数据API | 2天 |

### Phase 2: 功能页面（Week 3-4）

| 优先级 | 页面 | 依赖 | 工作量 |
|-------|------|------|--------|
| P1 | Calendar Page | 日历组件 | 1.5天 |
| P1 | User Profile | 认证系统 | 1.5天 |
| P2 | About Us | - | 0.5天 |

### Phase 3: 响应式适配（Week 5）

- Mobile Header 组件
- 移动端布局优化
- 断点适配: sm(640px) / md(768px) / lg(1024px) / xl(1280px)

---

## 🚀 开发计划与实际进度

### ✅ Phase 1: MVP启动 (计划1) - 100% 完成

**实际开发周期**: 2026-02-07 至 2026-02-09 (3天)

| 任务 | 计划用时 | 实际用时 | 状态 |
|------|---------|---------|------|
| 环境搭建 + 共享组件 | 2天 | 0.5天 | ✅ |
| Landing Page | 2天 | 0.5天 | ✅ |
| Login/Sign Up/404 | 3天 | 0.5天 | ✅ |
| Home Page | 1天 | 0.5天 | ✅ |
| Companies Directory | 2天 | 0.5天 | ✅ |
| Earnings Detail | 3天 | 1天 | ✅ |
| Calendar Page | 2天 | 0.5天 | ✅ |
| User Profile + About | 2天 | 0.5天 | ✅ |
| 测试 + 部署 | 3天 | 0.5天 | ✅ |

**交付成果**:
- ✅ 10个完整页面
- ✅ 共享组件系统
- ✅ Vercel部署成功
- ✅ 生产环境可访问

---

### ✅ Phase 2: AI自动化 (计划2) - 100% 完成

**实际开发周期**: 2026-02-09 至 2026-02-10 (2天)

| 任务 | 计划用时 | 实际用时 | 状态 |
|------|---------|---------|------|
| DeepSeek API集成 | 2小时 | 1小时 | ✅ |
| AI分析模块 | 4小时 | 2小时 | ✅ |
| 数据库Schema | 3小时 | 1小时 | ✅ |
| 前端集成 | 6小时 | 3小时 | ✅ |
| 数据获取脚本 | 6小时 | 2小时 | ✅ |
| 批量分析脚本 | 6小时 | 2小时 | ✅ |
| GitHub Actions | 4小时 | 2小时 | ⚠️ 90% |
| GitHub Secrets | 2小时 | 1小时 | ⚠️ 待配置 |

**交付成果**:
- ✅ AI分析引擎 (lib/ai.ts)
- ✅ 数据库迁移文件
- ✅ 23条财报数据
- ✅ 23条AI分析
- ✅ 自动化脚本
- ✅ GitHub Actions工作流
- ✅ GitHub Secrets已配置
- ✅ Vercel Deploy Hook集成

**数据状态 (计划2完成时)**:
| 表 | 记录数 | 状态 |
|----|--------|------|
| companies | 10 | ✅ |
| earnings | 23 | ✅ |
| ai_analyses | 23 | ✅ |

---

### 🚀 Phase 3: 规模化 (计划3) - 部分完成

**实际开发周期**: 2026-02-10 至今

#### 3a: 规模化基础 ✅ 已完成

| 任务 | 状态 |
|------|------|
| Tier 2公司(10家) | ✅ AVGO, ORCL, ADBE... |
| Tier 3公司(10家) | ✅ SNOW, CRWD, DDOG... |
| 财报数据补充 | ✅ 109条财报 |
| AI分析(100%) | ✅ 109/109分析完成 |
| 财报日历页面 | ✅ /calendar |
| 邮件订阅前端 | ✅ SubscribeForm组件 |
| 邮件订阅API | ✅ /api/subscribe |

#### 3b: 高级分析系统 ✅ 已完成

**Investment组件** (10个):
- ✅ InvestmentRatingCard - AI投资评级
- ✅ FinancialHealthScorecard - 财务健康
- ✅ DocumentViewer - 财报文档
- ✅ IndustryComparisonChart - 行业对比
- ✅ DupontAnalysisChart - 杜邦分析
- ✅ GrowthStageChart - 成长阶段
- ✅ ValuationGauge - 估值仪表盘
- ✅ ChatInterface - AI聊天
- ✅ AlertManagement - 警报管理
- ✅ NotificationPreferences - 通知偏好

**API路由** (17个):
- ✅ /api/companies, /api/earnings/*, /api/sectors, /api/calendar
- ✅ /api/subscribe, /api/alerts, /api/nps, /api/feedback
- ✅ /api/analysis/[symbol], /api/valuation/[symbol]
- ✅ /api/research/[symbol], /api/peers/[symbol]
- ✅ /api/stock-price/[symbol], /api/assistant/chat

**数据库迁移** (9个):
- ✅ 001-004: 基础表 + 测试数据
- ✅ 005: 投资系统 (估值/研报/分析师)
- ✅ 006: 向量嵌入 (RAG/对话)
- ✅ 007: 智能警报系统
- ✅ 20260212: 反馈系统
- ✅ 20260213: 股价数据

#### 3c: AdSense申请 ⏳ 待开始

| 任务 | 状态 |
|------|------|
| Privacy Policy页面 | ✅ /privacy |
| Terms of Service页面 | ✅ /terms |
| Contact页面 | ⏳ 待开发 |
| AdSense代码集成 | ⏳ 待开发 |

**当前数据状态 (2026-02-11)**:
| 表 | 记录数 | 状态 |
|----|--------|------|
| companies | 30 | ✅ Tier 1/2/3完成 |
| earnings | 109 | ✅ 100%公司覆盖 |
| ai_analyses | 109 | ✅ 100%分析覆盖 |
| subscribers | 0 | ✅ 功能就绪 |

**30家公司清单**:
- **Tier 1 (10家)**: AAPL, MSFT, GOOGL, NVDA, META, AMZN, TSLA, AMD, NFLX, CRM
- **Tier 2 (10家)**: AVGO, ORCL, ADBE, IBM, INTC, QCOM, TXN, NOW, PANW, PLTR  
- **Tier 3 (10家)**: SNOW, CRWD, DDOG, NET, MDB, ZS, OKTA, DOCU, ROKU, UBER

---

### ⏳ Phase 4-5: 增长与商业化 - 待开始

- **Phase 4**: SEO优化、流量增长 (Month 3)
- **Phase 5**: Pro订阅、商业化 (Month 4-6)

---

## 💰 商业模式

### Phase 1: 免费 + 广告（Month 1-2）

- 基础功能完全免费
- Google AdSense 展示广告
- 目标: 月 PV 30K → 收入 $150

### Phase 2: 高级订阅（Month 3-4）

**Pro 版 - $9.99/月 或 $99/年**:
- 实时财报提醒
- 深度对比分析
- 数据导出功能
- 无广告体验

### Phase 3: 企业服务（Month 6+）

- API 数据服务
- 定制研究报告
- 团队版订阅 ($49/月)

---

## 📊 成功指标与实际达成

### Month 1 目标 (2026-02)

| 目标 | 计划 | 实际 | 状态 |
|------|------|------|------|
| 10个页面开发 | ✅ | ✅ 10/10 | 100% |
| Vercel部署 | ✅ | ✅ 已上线 | 100% |
| 5家公司数据 | ✅ | ✅ 10家公司 | 200% |
| 网站可访问 | ✅ | ✅ 可访问 | 100% |

**Month 1 完成度**: 100% ✅

### Month 2 目标 (2026-02)

| 目标 | 计划 | 实际 | 状态 |
|------|------|------|------|
| AI分析功能 | ✅ | ✅ 109条分析 | 100% |
| 自动化数据 | ✅ | ✅ 脚本就绪 | 100% |
| 扩展到30家 | ✅ | ✅ 30家公司 | 100% |
| 邮件订阅功能 | ✅ | ✅ API+前端就绪 | 100% |
| 财报日历页面 | ✅ | ✅ /calendar | 100% |
| AdSense申请 | ⏳ | ⏳ Week 8进行 | 0% |

**Month 2 完成度**: 83% ✅ (Week 8进行中)

### 关键里程碑

- ✅ **2026-02-07**: 项目初始化完成
- ✅ **2026-02-09**: Plan 1 MVP部署成功
- ✅ **2026-02-10**: Plan 2 AI自动化完成100%
- ✅ **2026-02-10**: Plan 3 Week 5-7完成 (30家公司，109条财报)
- ⏳ **2026-02-11**: Plan 3 Week 8开始 (AdSense申请)
- ⏳ **2026-02-15**: AdSense审核提交 (预计)

### Month 3 目标

- [ ] 日 PV 1000+
- [ ] 自然搜索流量 > 50%
- [ ] 邮件订阅用户 100+
- [ ] 月收入 $50+

---

## 🛠️ 资源清单

| 资源 | 用途 | 成本 | 链接 |
|------|------|------|------|
| GitHub | 代码托管 | ¥0 | github.com |
| Vercel | 网站部署 | ¥0 | vercel.com |
| Supabase | 数据库 | ¥0 | supabase.com |
| FMP API | 财报数据 | ¥0 | financialmodelingprep.com |
| DeepSeek | AI分析 | ¥0.002/千tokens | platform.deepseek.com |
| Google AdSense | 广告变现 | 免费 | adsense.google.com |

---

## 📚 相关文档

- [计划1: MVP启动](./计划1-MVP启动.md)
- [计划2: AI自动化](./计划2-AI自动化.md)
- [计划3: 规模化](./计划3-规模化.md)
- [计划4: 增长优化](./计划4-增长优化.md)
- [计划5: 商业化](./计划5-商业化.md)
- [页面与交互逻辑梳理](../页面与交互逻辑梳理.md)

---

## ✅ 设计稿验收标准

所有设计稿已完成并满足以下标准：

- ✅ 13 个完整页面设计
- ✅ 统一的 Design Token 系统
- ✅ 组件交互状态规范 (Default/Hover/Active/Disabled)
- ✅ 响应式设计规范
- ✅ 可复用的共享组件 (Header)
- ✅ 所有页面包含一致的 Header + Footer

---

## 📋 当前状态总结

### ✅ 已完成 (97%)

**核心功能**:
- ✅ 10个页面完全开发
- ✅ Vercel生产部署
- ✅ Supabase数据库
- ✅ DeepSeek AI分析
- ✅ 109条财报数据 (30家公司)
- ✅ 109条AI分析 (100%覆盖)
- ✅ SVG图标系统 (15个图标)
- ✅ GitHub Actions自动化
- ✅ 财报日历页面 (/calendar)
- ✅ 邮件订阅功能 (API+前端)
- ✅ GitHub Secrets配置
- ✅ Vercel Deploy Hook

**技术栈**:
- ✅ Next.js 16.1.6 + React 19.2.3
- ✅ TypeScript 5
- ✅ Tailwind CSS 4
- ✅ shadcn/ui组件
- ✅ Supabase PostgreSQL
- ✅ DeepSeek API

### ⏳ 进行中 (3%)

**Week 8 - AdSense申请**:
1. **Privacy Policy页面** (2小时) ⏳
2. **Contact页面** (2小时) ⏳
3. **Terms of Service** (2小时) ⏳
4. **AdSense代码集成** (4小时) ⏳
5. **提交AdSense申请** (2小时) ⏳

### 🎯 下一步行动

**立即执行 (Week 8)**:
1. 创建 Privacy Policy / Contact / Terms 页面
2. 集成 AdSense 广告代码
3. 提交 AdSense 申请

**查看详细进度**:
- [计划1-MVP启动](./计划1-MVP启动/01-开发进度.md) - 100% 完成 ✅
- [计划2-AI自动化](./计划2-AI自动化/01-开发进度.md) - 100% 完成 ✅
- [计划3-规模化](./计划3-规模化/01-开发进度.md) - Week 7完成 ✅ | Week 8待开始 ⏳

---

**项目整体进度**: 97% ✅ | **生产环境**: 已上线 🚀 | **计划3**: Week 7完成，Week 8进行中
