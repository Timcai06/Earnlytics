# 计划2：AI自动化

> **目标**: 集成DeepSeek API，实现数据自动获取和AI分析  
> **时间**: Week 3-4（10个工作日）  
> **前置**: 计划1 MVP已上线  
> **成本**: ¥5-10/月

---

## 🎯 阶段目标

- [ ] DeepSeek API集成，自动生成AI分析
- [ ] 自动数据获取（定时任务）
- [ ] 自动部署（新数据自动上线）
- [ ] 扩展到10家公司

---

## 🏗️ 技术方案

### 新增服务

| 服务 | 用途 | 成本 |
|------|------|------|
| DeepSeek API | AI财报分析 | ¥0.002/千tokens |
| GitHub Actions | 自动化任务 | 免费 |
| FMP API | 财报数据 | 免费额度 |

### 数据库变更

```sql
-- 新增AI分析表
CREATE TABLE ai_analyses (
  id SERIAL PRIMARY KEY,
  earnings_id INTEGER REFERENCES earnings(id),
  summary TEXT,
  highlights JSONB,
  concerns JSONB,
  sentiment VARCHAR(20),
  tokens_used INTEGER,
  cost_usd DECIMAL(10, 6)
);

-- 添加到earnings表
ALTER TABLE earnings ADD COLUMN is_analyzed BOOLEAN DEFAULT FALSE;
```

---

## 📋 核心任务

### Week 3: AI分析引擎

**Day 1-2**: DeepSeek配置
- 注册DeepSeek账号
- 充值API额度
- 编写AI分析模块

**Day 3-4**: 数据库升级
- 创建ai_analyses表
- 添加is_analyzed字段
- 测试数据插入

**Day 5**: 测试AI分析
- 编写测试脚本
- 验证分析质量
- 优化Prompt

### Week 4: 自动化流水线

**Day 6-7**: 数据获取脚本
- FMP API集成
- 定时获取财报数据
- 数据清洗和存储

**Day 8-9**: GitHub Actions配置
- 每4小时自动运行
- 获取数据 → AI分析 → 触发部署

**Day 10**: 批量分析脚本
- 处理未分析的财报
- 成本监控
- 错误处理

---

## ✅ 验收标准

- [ ] DeepSeek API正常运行
- [ ] 新财报自动获取并分析
- [ ] 页面自动更新（ISR）
- [ ] 10家公司数据正常展示
- [ ] GitHub Actions运行正常
- [ ] 月均成本<¥10

---

## 💰 成本估算

| 项目 | 数量/月 | 单价 | 月成本 |
|------|---------|------|--------|
| DeepSeek API | 50次分析 | ¥0.004/次 | ¥0.2 |
| 其他 | - | 免费 | ¥0 |
| **总计** | | | **¥0.2** |

---

## 📁 相关文档

- [详细开发进度](./01-开发进度.md) - 每日任务跟踪
- [计划1-MVP启动](../计划1-MVP启动/) - 上一阶段
- [计划3-规模化](../计划3-规模化/) - 下一阶段

---

**前置条件**: 计划1完成并部署上线
